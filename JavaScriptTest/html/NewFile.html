<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<!-- jQuery と jQuery UI をインポート -->
	<link rel="stylesheet" href="lib/themes/base/jquery.ui.all.css" />
	<script type="text/javascript" src="lib/jquery-1.9.1.js"></script>
	<script type="text/javascript" src="lib/ui/jquery-ui.js"></script>

	<!-- テストデータ -->
	<script type="text/javascript" src="../estimate_test_data.js"></script>

	<script type="text/javascript" src="../DrawTest.js"></script>
	<link href="css/zackmest.css" rel="stylesheet">
	<title>Insert title here</title>
	
<script type="text/javascript">

var PROCESS_CODE = {1:"要件定義", 2:"基本設計", 3:"詳細設計", 4:"結合テスト"};

/* onload によってグラフを描画する */
window.onload = function() {
	document.getElementById("cv").width = getGraphWidth(estimateDataJson.estimateValue[0]);
	// 初期表示はとりあえずいろいろなパターンが入ったデータを表示
	drawEstimateCanvas(estimateDataJson.estimateValue[0]);
}

$(function() {

	// 「ざっくり見積り」ボタン
	$( "button:first" ).button({
		icons: {
			primary: " ui-icon-calculator"
		},
		text: true
	}).click(function(){ /* クリック時の動作 */ });
	
	// スライドバー
    $("#jquery-ui-slider").slider( {
        orientation: 'horizontal',
        animate: "nomal",
        range: true,
        values: [ 1, 5 ],
        min: 1,
        max: 5,
        slide: function( event, ui ) {

        	// スライドによって範囲が重複する場合には移動させない 
        	if (ui.values[0] == ui.values[1]) {
	        	return false;
			}

            // スライダの選択値からパターンIDを生成する 
            var patternId = (function(){
            	var selectedRange = String(ui.values[0]) + String(ui.values[1]);
            	var patternId = "";
            	
            	for (var i = 1 ; i <= 4; i++ ) {
            		patternId += (ui.values[0] <= i && i < ui.values[1]) ? "1" : "0";
            	}
            	
            	return patternId;
            })();
            
            // パターンIDに対応する見積データのグラフ描画と工程・工数領域への選択状態反映 
            for (var i in estimateDataJson.estimateValue) {
            	
            	if (estimateDataJson.estimateValue[i].patternId == patternId) {
            		drawEstimateCanvas(estimateDataJson.estimateValue[i]);

            		// 工程・工数領域のスクロール位置と選択状態の表のアクティブ化 
            		$("#process_workmonth_table_area").scrollLeft(i * 214);
            		$("#process_workmonth_table_area_inner th").removeClass("table_active");
            		var str = "#process_workmonth_table_area_inner table:nth-of-type(" + (Number(i) + 1) + ") th";
	        		$(str).addClass("table_active");
            		break;
            	}
            }
            
            // スライダで指定した範囲に対応するタイトルを作成 
            var graphTitle = (function() {
            	var title;
            	if (patternId.indexOf("1") ==  patternId.lastIndexOf("1")){
                	title = PROCESS_CODE[patternId.indexOf("1") + 1];
            	} else {
                	title = PROCESS_CODE[patternId.indexOf("1") + 1];
                	title += " 〜 "
                	title += PROCESS_CODE[patternId.lastIndexOf("1") + 1];
            	}
            	return title + " 工程工数グラフ";
            })();

            // 選択範囲内のスライダのキャプションのスタイルを活性化する 
            for (var i in patternId) {
            	var index = Number(i) + 1;
            	if (patternId[i] == "1") {
            		$("#process_cap_" + index).addClass("process_name_" + index);
	        		$("#process_cap_" + index).addClass("process_name_base");
            	} else {
            		$("#process_cap_" + index).removeClass("process_name_" + index);
        			$("#process_cap_" + index).removeClass("process_name_base");
            	}
            }

            $("#graph_title").text(graphTitle);
            
        }
    } );
    
//    jQuery('#jquery-ui-slider-values-1').val(jQuery('#jquery-ui-slider').slider('values',1 ));
} );
</script> 

</head>
<body>

<!-- Web定規 -->
<div class="ruler_area">
	<div class="ruler">1</div><div class="ruler">2</div><div class="ruler">3</div>
	<div class="ruler">4</div><div class="ruler">5</div>
	<div class="ruler">6</div><div class="ruler">7</div><div class="ruler">8</div>
	<div class="ruler">9</div><div class="ruler">10</div>
</div>

<!-- レイアウト調整 -->
<div class="filler">&nbsp;</div>

<!-- ざっくり条件指定領域 -->
<div id="calc_condition_area">
	<fieldset id="calc_condition_field">
		<legend>ざっくり条件指定</legend>
		<table id="calc_condition_table_left" class="lookgood_table">
			<tr>
				<th>プログラムサイズ(Ks)</th>
				<td><input type="text" size="8" maxlength="5" /></td>
			</tr>
			<tr>
				<th>ファンクションポイント数</th>
				<td><input type="text" size="8" maxlength="5" /></td>
			</tr>
			<tr>
				<th>生産性(Ks)</th>
				<td><input type="text" size="8" maxlength="5" /></td>
			</tr>
		</table>
		<table id="calc_condition_table_right" class="lookgood_table">
			<tr>
				<th>開発期間(月)</th>
				<td><input type="text" size="8" maxlength="5" /></td>
			</tr>
			<tr>
				<th>工数(人月)</th>
				<td><input type="text" size="8" maxlength="5" /></td>
			</tr>
		</table>
		<button id="submit_estimate">ざっくり見積り</button>
	</fieldset>
</div>

<!-- レイアウト調整 -->
<div class="filler">&nbsp;</div>

<!-- 基礎数値表示領域 -->
<div id="base_value_area">
	<div id="base_value_left_pane">
		<div>
			<div class="table_title"><span class="title">作業工数</span></div>
			<table id="" class="lookgood_table">
				<tr>
					<th>工数を月で分割</th>
					<td>5.56 人月</td>
				</tr>
			</table>
		</div>

		<!-- レイアウト調整 -->
		<div class="filler">&nbsp;</div>

		<div>
			<div class="table_title"><span class="title">工期の妥当性評価</span></div>
			<table id="" class="lookgood_table">
				<tr>
					<th>最短開発期間</th>
					<td>7.7 ヶ月</td>
				</tr>
				<tr>
					<th>標準工期</th>
					<td>5.8 ヶ月</td>
				</tr>
			</table>
		</div>
	</div>
	<div id="base_value_right_pane">
		<div class="table_title"><span class="title">規模予測</span></div>
		<table id="" class="lookgood_table">
			<tr>
				<th>プログラムサイズ</th>
				<td>30 Ks</td>
			</tr>
			<tr>
				<th>ファンクションポイント数</th>
				<td>5.8 FP</td>
			</tr>
			<tr>
				<th>生産性</th>
				<td>1 Ks</td>
			</tr>
			<tr>
				<th>開発期間</th>
				<td>6 ヶ月</td>
			</tr>
			<tr>
				<th>工数</th>
				<td>33 人月</td>
			</tr>
		</table>
	</div>
</div>

<!-- レイアウト調整 -->
<div class="filler">&nbsp;</div>
<div class="filler">&nbsp;</div>

<div class="estimate_title">
	<span id="graph_title">工程工数グラフ</span>
</div>
 
<!-- グラフ（凡例）領域 -->
<div class="estimate_legend_area">
	
	<div id="slider_area">
		<!-- スライダキャプション領域 -->
		<div id="slider_caption_area">
			<table id="slider_caption_table">
				<tr>
					<th><img src="image/ProcessRequirementDefinition.png" width="15px"/></th>
					<td id="process_cap_1" class="process_name_none">要件定義</td>
					<th><img src="image/ProcessBasicDesign.png" width="15px"/></th>
					<td id="process_cap_2" class="process_name_none">基本設計</td>
					<th><img src="image/ProcessImpl.png" width="15px"/></th>
					<td id="process_cap_3" class="process_name_none">実装</td>
					<th><img src="image/ProcessTest.png" width="15px"/></th>
					<td id="process_cap_4" class="process_name_none">結合テスト</td>
				</tr>
			</table>
		</div>
		
		<!-- スライダ領域 -->
		<div id="jquery-ui-slider-wrap">
		    <!-- スライダ色の変更は .ui-widget-header -->
		    <!-- スライダのツマミ色の変更は .ui-state-default, .ui-widget-content .ui-state-default, .ui-widget-header .ui-state-default -->
		    <div id="jquery-ui-slider"></div>
		</div>
	</div>

	<div class="estimate_legend">
		<fieldset class="legend_field">
			<legend>凡例</legend>
			<table class="legend_table">
				<tr>
					<th><img src="image/TermJuas.png" width="15px"/></th>
					<td>
						標準工期
					</td>
				</tr>
				<tr>
					<th><img src="image/TermSlim.png" width="15px"/></th>
					<td>
						最短開発期間
					</td>
				</tr>
			</table>
		</fieldset>
	</div>
</div>

<!-- グラフ領域 -->
<div class="estimate_graph_area">

	<div class="estimate_scale">
		<!-- グラフY軸の目盛り -->
		<canvas id="cv_scale" class="scale" width="50" height="270">
		  <!--Canvas機能に対応していないブラウザへの備え-->
		  Canvas機能に対応したブラウザでアクセスしてください。
		</canvas>
	</div>
	<div class="estimate_pane">
		<!-- グラフ本体 -->
		<canvas id="cv" class="graph" height="270" >
		  <!--Canvas機能に対応していないブラウザへの備え-->
		  Canvas機能に対応したブラウザでアクセスしてください。
		</canvas>
	</div>
</div>

<!-- レイアウト調整 -->
<div class="filler">&nbsp;</div>

<!-- 工数・工程表示領域 -->
<div id="process_workmonth_area">
	<div class="table_title"><span class="title">工程と工数</span></div>
	<div id="process_workmonth_caption_table_area">
		<table id="process_workmonth_caption_table">
			<tr><th rowspan="2">工程</th></tr>
			<tr></tr>
			<tr><th class="process_name_1">要件定義</th></tr>
			<tr><th class="process_name_2">基本設計</th></tr>
			<tr><th class="process_name_3">詳細設計</th></tr>
			<tr><th class="process_name_3">実装</th></tr>
			<tr><th class="process_name_3">ユニットテスト</th></tr>
			<tr><th class="process_name_4">結合テスト</th></tr>
			<tr><th class="process_name_4">総合テスト</th></tr>
		</table>
	</div>
	<div id="process_workmonth_table_area">
		<div id="process_workmonth_table_area_inner">
			<table class="process_workmonth_table">
				<tr><th colspan="3">要件定義〜結合テスト</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">要件定義〜詳細設計</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">要件定義〜基本設計</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">要件定義</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">基本設計〜結合テスト</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">基本設計〜詳細設計</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">基本設計</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">詳細設計〜結合テスト</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">詳細設計</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
			<table class="process_workmonth_table">
				<tr><th colspan="3">結合テスト</th></tr>
				<tr><th>工期(月)</th><th>工数(工程)</th><th>工数(月)</th></tr>
				<tr><td>1.1</td><td>3.2</td><td>2.9</td></tr>
				<tr><td>1.5</td><td>8.6</td><td>5.7</td></tr>
				<tr><td rowspan="3">1.8</td><td rowspan="3">13.8</td><td rowspan="3">7.7</td></tr>
				<tr></tr>
				<tr></tr>
				<tr><td rowspan="2">1.7</td><td rowspan="2">7.8</td><td rowspan="2">4.9</td></tr>
				<tr></tr>
			</table>
		</div>
	</div>
</div>

<!-- Web定規 -->
<div class="ruler_area">
	<div class="ruler">1</div><div class="ruler">2</div><div class="ruler">3</div>
	<div class="ruler">4</div><div class="ruler">5</div>
	<div class="ruler">6</div><div class="ruler">7</div><div class="ruler">8</div>
	<div class="ruler">9</div><div class="ruler">10</div>
</div>

</body>
</html>